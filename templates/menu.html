{% extends 'base.html' %}
{% block title %}Menu – {{ name }}{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/user_menu.css') }}">
{% endblock %}

{% block body %}
<div class="menu-page">

  <!-- top bar -->
  <header class="menu-header">
    <button class="back-btn" type="button" onclick="history.back()">
      <img src="{{ url_for('static', filename='icons/backarrow.svg') }}" alt="Back">
    </button>
  </header>

  <!-- centered menu image -->
  <div class="menu-content">
    {% if menu_image %}
      <img src="{{ url_for('static', filename=menu_image) }}"
           alt="Menu for {{ name }}">
    {% else %}
      <p class="menu-placeholder">
        The menu isn’t uploaded yet. Please check back later.
      </p>
    {% endif %}
  </div>

  {% if assigned_drink %}
    <!-- bottom drink bar -->
    <footer class="drink-bar">
      <p>
        <strong>{{ assigned_drink }}</strong>
      </p>
    </footer>
  {% endif %}

</div>
{% endblock %}

{% block extra_js %}
  <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
  <script>
    const socket = io();
    socket.on('rate_course', p => {
      if (p && p.course_id) {
        location.href = `/rate/${p.course_id}/{{ name|urlencode }}`;
      }
    });
    socket.on('stop_rating', () =>
      location.href = `/menu/{{ name|urlencode }}`
    );
  </script>
{% endblock %}